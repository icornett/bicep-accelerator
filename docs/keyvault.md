# keyvault br:icornett.azurecr.io/bicep/modules/keyvault:v1.0

## Parameters

| Parameter Name            | Parameter Type | Parameter Description                                                                                                                                                                                                                                                                                                                                                                                                           | Parameter DefaultValue     | Parameter AllowedValues |
| ------------------------- | -------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------- | ----------------------- |
| createMode                | string         | The vault's create mode to indicate whether the vault need to be recovered or not.                                                                                                                                                                                                                                                                                                                                              | default                    | default,recover         |
| enablePurgeProtection     | bool           | Property specifying whether protection against purge is enabled for this vault. Setting this property to true activates protection against purge for this vault and its content - only the Key Vault service may initiate a hard, irrecoverable deletion. The setting is effective only if soft delete is also enabled. Enabling this functionality is irreversible - that is, the property does not accept false as its value. | False                      |                         |
| enableSoftDelete          | bool           | Property to specify whether the `soft delete` functionality is enabled for this key vault. If not set to any value(true or false) when creating new key vault, it will be set to true by default. Once set to `true`, it cannot be reverted to `false`.                                                                                                                                                                         | False                      |                         |
| iaasSubnetName            | string         | The subnet name hosting Azure Monitor                                                                                                                                                                                                                                                                                                                                                                                           |                            |                         |
| keyVaultName              | string         | The name of the key vault instance                                                                                                                                                                                                                                                                                                                                                                                              |                            |                         |
| location                  | string         | The location to deploy resources to                                                                                                                                                                                                                                                                                                                                                                                             | [resourceGroup().location] |                         |
| skuName                   | string         | SKU name to specify whether the key vault is a standard vault or a premium vault.                                                                                                                                                                                                                                                                                                                                               | standard                   | premium,standard        |
| softDeleteRetentionInDays | int            | softDelete data retention days. It accepts >=7 and <=90.                                                                                                                                                                                                                                                                                                                                                                        | 7                          |                         |
| tags                      | object         | A mapping of tags to assign to resources                                                                                                                                                                                                                                                                                                                                                                                        |                            |                         |
| vnetName                  | string         | The name of the virtual network                                                                                                                                                                                                                                                                                                                                                                                                 |                            |                         |
| vnetRgName                | string         | The resource group of the virtual network                                                                                                                                                                                                                                                                                                                                                                                       |                            |                         |

## Resources

| Deployment Name | Resource Type                      | Resource Version | Existing | Resource Comment |
| --------------- | ---------------------------------- | ---------------- | -------- | ---------------- |
| keyVault        | Microsoft.KeyVault/vaults          | 2023-02-01       | False    |                  |
| keyVaultLock    | Microsoft.Authorization/locks      | 2017-04-01       | False    |                  |
| kvEndpoint      | Microsoft.Network/privateEndpoints | 2022-01-01       | False    |                  |

## Outputs

| Output Name | Output Type | Output Value                                                          |
| ----------- | ----------- | --------------------------------------------------------------------- |
| id          | string      | [resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName'))] |
| name        | string      | [parameters('keyVaultName')]                                          |
